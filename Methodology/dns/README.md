## 1. Identify Unusual Number of DNS Queries from a Single IP
```bash
cat dns.log | zeek-cut id.orig_h | sort | uniq -c | sort -nr | awk '$1 > 100'
```
**Interpretation**:  
- **Normal**: A moderate number of DNS queries (e.g., several dozen) from known devices within a typical timeframe.  
- **Abnormal**: More than 100 queries from a single source IP in a short period may indicate DNS enumeration or scanning.

## 2. Detect Queries to Uncommon or Suspicious Domains
```bash
cat dns.log | zeek-cut query | grep -E '\.(xyz|top|info|xyz|ml)$' | sort | uniq -c | sort -nr
```
**Interpretation**:  
- **Normal**: Queries to well-known domains (e.g., .com, .org).  
- **Abnormal**: Frequent queries to less common domain extensions (like .xyz or .info) could indicate malicious intent or use of disposable domains.

## 3. Monitor for DNS Response Codes Indicating Errors or Failures
```bash
cat dns.log | zeek-cut id.orig_h id.resp_p rcode | grep -E '2|3|5' | sort | uniq -c | sort -nr
```
**Interpretation**:  
- **Normal**: A few error responses from DNS queries may occur due to transient network issues.  
- **Abnormal**: Multiple failed responses (e.g., NXDOMAIN, SERVFAIL) may indicate probing or misconfigurations in DNS settings.

## 4. Identify High Volume of Queries for a Single Domain
```bash
cat dns.log | zeek-cut query | sort | uniq -c | sort -nr | awk '$1 > 50'
```
**Interpretation**:  
- **Normal**: Occasional high query volume for popular or well-known domains (e.g., Google).  
- **Abnormal**: More than 50 queries to the same domain in a short period may indicate an attempt to resolve a suspicious or newly registered domain.

## 5. Analyze Query Patterns Based on Time of Day
```bash
cat dns.log | zeek-cut id.orig_h query start_time | awk '{print strftime("%H", $3)}' | sort | uniq -c | sort -nr
```
**Interpretation**:  
- **Normal**: Regular DNS queries occurring during business hours.  
- **Abnormal**: Significant activity during off-hours (e.g., late-night queries) may indicate automated processes or unauthorized access.

## 6. Monitor for Repeated Queries from the Same IP
```bash
cat dns.log | zeek-cut id.orig_h query | sort | uniq -c | sort -nr | awk '$1 > 10'
```
**Interpretation**:  
- **Normal**: Isolated repeated queries to common internal or trusted external services.  
- **Abnormal**: More than 10 repeated queries to the same domain from the same IP may indicate DNS amplification attacks or malware communication.

## 7. Identify Queries for Non-Existent Domains
```bash
cat dns.log | zeek-cut query rcode | grep 'NXDOMAIN' | sort | uniq -c | sort -nr
```
**Interpretation**:  
- **Normal**: Occasional NXDOMAIN responses due to typos or non-existent internal resources.  
- **Abnormal**: A high volume of NXDOMAIN responses may indicate malicious attempts to probe for vulnerable or misconfigured services.

## 8. Check for Queries to Known Malicious Domains
```bash
cat dns.log | zeek-cut query | grep -f known_malicious_domains.txt | sort | uniq -c | sort -nr
```
**Interpretation**:  
- **Normal**: Rare queries to potentially risky domains (like ad servers).  
- **Abnormal**: Frequent queries to a list of known malicious domains could indicate compromised systems or users.

## 9. Monitor for Domain Generation Algorithms (DGA)
```bash
cat dns.log | zeek-cut query | grep -E '^[a-zA-Z0-9]{8,}\.com$' | sort | uniq -c | sort -nr
```
**Interpretation**:  
- **Normal**: Standard DNS queries from legitimate applications or services.  
- **Abnormal**: Queries to domain names generated by algorithms (DGA) typically used by malware for command and control may signify a security incident.

## 10. Check if Domains are Dynamic and Their Registration Dates
```bash
cat dns.log | zeek-cut query | sort | uniq | while read domain; do whois $domain | grep -E 'Domain Name|Creation Date|Expiration Date'; done
```
**Interpretation**:  
- **Normal**: Domains with established registration dates and stable ownership.  
- **Abnormal**: Recently registered domains (e.g., created within the last 30 days) or domains associated with dynamic DNS providers may indicate potential malicious activity or malware.

## 11. Checking if a Domain is Dynamic DNS (DDNS)
```bash
cat dns.log | zeek-cut query | sort | uniq | grep -E '\.(dyndns|no-ip|duckdns|afraid|changeip|dnshost|ddns)\.com$'
```
**Interpretation**:  
- **Normal**: Occasional queries to dynamic DNS providers as part of legitimate services.
- **Abnormal**: Frequent queries to DDNS domains may indicate suspicious behavior, such as malware trying to connect to rapidly changing IP addresses.

## 12. Checking Domain Registration Dates
```bash
cat dns.log | zeek-cut query | sort | uniq | while read domain; do whois $domain | grep -E 'Domain Name|Creation Date'; done | grep "$(date -d '30 days ago' '+%Y-%m-%d')"
```
**Interpretation**:  
- **Normal**: Domains that have been registered for a longer time (e.g., several months or years).
- **Abnormal**: Newly registered domains (created within the last 30 days) may indicate potential malicious activity, especially if they are frequently queried or associated with unusual patterns.
```